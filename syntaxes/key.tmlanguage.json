{
    "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
    "injectionSelector": "L:source.namu",
    "name": "Namuwiki Code",
    "scopeName": "source.namu",
    "patterns": [
        {
            "include": "#wiki-patterns"
        }
    ],
    "repository": {
        "wiki-patterns": {
            "patterns": [
                {
                    "include": "#comments"
                },
                {
                    "include": "#links"
                },
                {
                    "include": "#includes"
                },
                {
                    "include": "#rubys"
                },
                {
                    "include": "#anchors"
                },
                {
                    "include": "#math"
                },
                {
                    "include": "#macros"
                },
                {
                    "include": "#titles"
                },
                {
                    "include": "#markups"
                },
                {
                    "include": "#lists"
                },
                {
                    "include": "#brackets"
                },
                {
                    "include": "#footnotes"
                },
                {
                    "include": "#redirect"
                },
                {
                    "include": "#tables"
                }
            ]
        },
        "comments": {
            "name": "comment.line.double-quote.namu",
            "match": "#{2,}.*"
        },
        "titles": {
            "name": "keyword.control.namu",
            "match": "^(={1,6})(#?) (.*) (\\2)(\\1)$"
        },
        "links": {
            "match": "\\[{2}([^|\\]\\[]*)((\\|)([^|\\]\\[]*))?\\]{2}",
            "captures": {
                "1": {
                    "name": "string.quoted.double.namu"
                },
                "4": {
                    "name": "support.constant.namu"
                }
            }
        },
        "includes": {
            "begin": "\\[(include)\\(",
            "beginCaptures": {
                "1": { "name": "keyword.control.include.namu" }
            },
            "end": "\\)\\]",
            "patterns": [
                {
                    "match": "((?:\\.|[^,=\\)\\]])+)(?:=((?:\\\\.|[^,\\)\\]])+))?(?:,(?![^\\\\]))?",
                    "captures": {
                        "1": { "name": "variable.parameter.key.namu" },
                        "2": { "name": "string.unquoted.argument.namu" }
                    }
                }
            ]
        },
        "rubys": {
            "begin": "\\[(?=ruby)",
            "end": "\\]",
            "patterns": [
                {
                    "name": "keyword.control.namu",
                    "match": "ruby(?=\\()"
                },
                {
                    "name": "string.quoted.double.namu",
                    "match": "(?<=ruby\\().[^\\,]*(\\){1,})?(?=,)"
                },
                {
                    "name": "variable.parameter.namu",
                    "match": "(?<=\\,)[^\\=]*(?=\\=)"
                },
                {
                    "name": "string.quoted.double.namu",
                    "match": "(?<=ruby\\=)[^\\)\\]]*(\\){1,})?(?=\\)\\])"
                }
            ]
        },
        "anchors": {
            "match": "\\[((anchor|age|dday|youtube|kakaotv|niconicovideo|vimeo|nicovideo|navertv)\\(([^\\)]*(\\){1,})?)\\)|(pagecount)(\\(([^\\)]*(\\){1,})?)\\))?)\\]",
            "captures": {
                "2": {
                    "name": "keyword.control.namu"
                },
                "3": {
                    "name": "variable.parameter.namu"
                },
                "5": {
                    "name": "keyword.control.namu"
                },
                "7": {
                    "name": "variable.parameter.namu"
                }
            }
        },
        "math": {
            "name": "meta.embedded.block.tex",
            "begin": "\\[(math)",
            "beginCaptures": {
                "1": { "name": "keyword.control.namu" }
            },
            "end": "\\]",
            "patterns": [{ "include": "text.tex.latex" }]
        },
        "macros": {
            "begin": "\\[(?=clearfix|date|datetime|목차|tableofcontents|각주|footnote|br)",
            "end": "\\]",
            "patterns": [
                {
                    "name": "keyword.control.namu",
                    "match": "clearfix|date|datetime|목차|tableofcontents|각주|footnote|br"
                }
            ]
        },
        "markups": {
            "patterns": [
                {
                    "name": "markup.bold.namu",
                    "match": "'''[^']*'''"
                },
                {
                    "name": "markup.italic.namu",
                    "match": "(''[^']*''|__[^_]*__)"
                },
                {
                    "name": "keyword.control.namu",
                    "match": "-{4,9}"
                },
                {
                    "name": "keyword.operator.namu",
                    "match": "^(> ?){1,8}"
                }
            ]
        },
        "lists": {
            "patterns": [
                {
                    "name": "keyword.operator.namu",
                    "match": "(?<=^(> ?){0,8} ( )*)(\\*|1\\.|a\\.|A\\.|i\\.|I\\.(\\#[0-9][0-9]?)?)"
                }
            ]
        },
        "brackets": {
            "name": "meta.block.special.namu",
            "begin": "(\\{\\{\\{)",
            "beginCaptures": {
                "1": { "name": "punctuation.section.block.begin.namu" }
            },
            "end": "(\\}\\}\\})",
            "endCaptures": {
                "1": { "name": "punctuation.section.block.end.namu" }
            },
            "patterns": [
                {
                    "match": "(?<!^\\s*)(\\+[0-9]|#[A-Fa-f0-9]{3,6}(?:,#[A-Fa-f0-9]{3,6})?)(?=\\s|$)",
                    "captures": { "1": { "name": "support.constant.color.namu" } }
                },
                {
                    "match": "(?i)(?<!^\\s*)(#(?:AliceBlue|AntiqueWhite|Aqua|Aquamarine|Azure|Beige|Bisque|Black|BlanchedAlmond|Blue|BlueViolet|Brown|BurlyWood|CadetBlue|Chartreuse|Chocolate|Coral|CornflowerBlue|Cornsilk|Crimson|Cyan|DarkBlue|DarkCyan|DarkGoldenRod|DarkGray|DarkGrey|DarkGreen|DarkKhaki|DarkMagenta|DarkOliveGreen|DarkOrange|DarkOrchid|DarkRed|DarkSalmon|DarkSeaGreen|DarkSlateBlue|DarkSlateGray|DarkSlateGrey|DarkTurquoise|DarkViolet|DeepPink|DeepSkyBlue|DimGray|DimGrey|DodgerBlue|FireBrick|FloralWhite|ForestGreen|Fuchsia|Gainsboro|GhostWhite|Gold|GoldenRod|Gray|Grey|Green|GreenYellow|HoneyDew|HotPink|IndianRed|Indigo|Ivory|Khaki|Lavender|LavenderBlush|LawnGreen|LemonChiffon|LightBlue|LightCoral|LightCyan|LightGoldenRodYellow|LightGray|LightGrey|LightGreen|LightPink|LightSalmon|LightSeaGreen|LightSkyBlue|LightSlateGray|LightSlateGrey|LightSteelBlue|LightYellow|Lime|LimeGreen|Linen|Magenta|Maroon|MediumAquaMarine|MediumBlue|MediumOrchid|MediumPurple|MediumSeaGreen|MediumSlateBlue|MediumSpringGreen|MediumTurquoise|MediumVioletRed|MidnightBlue|MintCream|MistyRose|Moccasin|NavajoWhite|Navy|OldLace|Olive|OliveDrab|Orange|OrangeRed|Orchid|PaleGoldenRod|PaleGreen|PaleTurquoise|PaleVioletRed|PapayaWhip|PeachPuff|Peru|Pink|Plum|PowderBlue|Purple|RebeccaPurple|Red|RosyBrown|RoyalBlue|SaddleBrown|Salmon|SandyBrown|SeaGreen|SeaShell|Sienna|Silver|SkyBlue|SlateBlue|SlateGray|SlateGrey|Snow|SpringGreen|SteelBlue|Tan|Teal|Thistle|Tomato|Turquoise|Violet|Wheat|White|WhiteSmoke|Yellow|YellowGreen)(?:,#(?:AliceBlue|AntiqueWhite|Aqua|Aquamarine|Azure|Beige|Bisque|Black|BlanchedAlmond|Blue|BlueViolet|Brown|BurlyWood|CadetBlue|Chartreuse|Chocolate|Coral|CornflowerBlue|Cornsilk|Crimson|Cyan|DarkBlue|DarkCyan|DarkGoldenRod|DarkGray|DarkGrey|DarkGreen|DarkKhaki|DarkMagenta|DarkOliveGreen|DarkOrange|DarkOrchid|DarkRed|DarkSalmon|DarkSeaGreen|DarkSlateBlue|DarkSlateGray|DarkSlateGrey|DarkTurquoise|DarkViolet|DeepPink|DeepSkyBlue|DimGray|DimGrey|DodgerBlue|FireBrick|FloralWhite|ForestGreen|Fuchsia|Gainsboro|GhostWhite|Gold|GoldenRod|Gray|Grey|Green|GreenYellow|HoneyDew|HotPink|IndianRed|Indigo|Ivory|Khaki|Lavender|LavenderBlush|LawnGreen|LemonChiffon|LightBlue|LightCoral|LightCyan|LightGoldenRodYellow|LightGray|LightGrey|LightGreen|LightPink|LightSalmon|LightSeaGreen|LightSkyBlue|LightSlateGray|LightSlateGrey|LightSteelBlue|LightYellow|Lime|LimeGreen|Linen|Magenta|Maroon|MediumAquaMarine|MediumBlue|MediumOrchid|MediumPurple|MediumSeaGreen|MediumSlateBlue|MediumSpringGreen|MediumTurquoise|MediumVioletRed|MidnightBlue|MintCream|MistyRose|Moccasin|NavajoWhite|Navy|OldLace|Olive|OliveDrab|Orange|OrangeRed|Orchid|PaleGoldenRod|PaleGreen|PaleTurquoise|PaleVioletRed|PapayaWhip|PeachPuff|Peru|Pink|Plum|PowderBlue|Purple|RebeccaPurple|Red|RosyBrown|RoyalBlue|SaddleBrown|Salmon|SandyBrown|SeaGreen|SeaShell|Sienna|Silver|SkyBlue|SlateBlue|SlateGray|SlateGrey|Snow|SpringGreen|SteelBlue|Tan|Teal|Thistle|Tomato|Turquoise|Violet|Wheat|White|WhiteSmoke|Yellow|YellowGreen))?)(?=\\s|$)",
                    "captures": { "1": { "name": "support.constant.color.namu" } }
                },
                {
                    "match": "(#!folding\\s*)(.*)",
                    "captures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "string.quoted.other.namu" }
                    }
                },
                {
                    "match": "(#!wiki)(?:\\s+(?:(?:(style)=\\\"([^\"]*)\\\"(?:\\s+(dark-style)=\\\"([^\"]*)\\\")?)|(?:(dark-style)=\\\"([^\"]*)\\\"(?:\\s+(style)=\\\"([^\"]*)\\\")?)))?",
                    "captures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "variable.parameter.bracket.namu" },
                        "3": { "name": "meta.embedded.line.css", "patterns": [{ "include": "#wiki-style-line-css" }] },
                        "4": { "name": "variable.parameter.bracket.namu" },
                        "5": { "name": "meta.embedded.line.css", "patterns": [{ "include": "#wiki-style-line-css" }] },
                        "6": { "name": "variable.parameter.bracket.namu" },
                        "7": { "name": "meta.embedded.line.css", "patterns": [{ "include": "#wiki-style-line-css" }] },
                        "8": { "name": "variable.parameter.bracket.namu" },
                        "9": { "name": "meta.embedded.line.css", "patterns": [{ "include": "#wiki-style-line-css" }] }
                    }
                },
                {
                    "name": "meta.embedded.block.html",
                    "begin": "(#!html)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" }
                    },
                    "end": "(?=\\})",
                    "patterns": [{ "include": "text.html.derivative" }]
                },
                {
                    "name": "meta.embedded.block.javascript",
                    "begin": "(#!if)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" }
                    },
                    "end": "(?=\\n)",
                    "patterns": [
                        {
                            "include": "source.js"
                        }
                    ]
                },
                {
                    "name": "meta.embedded.block.basic",
                    "begin": "(#!syntax)\\s+(basic)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.asp.vb.net" }]
                },
                {
                    "name": "meta.embedded.block.cpp",
                    "begin": "(#!syntax)\\s+(cpp)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.cpp" }]
                },
                {
                    "name": "meta.embedded.block.csharp",
                    "begin": "(#!syntax)\\s+(csharp)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.cs" }]
                },
                {
                    "name": "meta.embedded.block.css",
                    "begin": "(#!syntax)\\s+(css)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.css" }]
                },
                {
                    "name": "meta.embedded.block.erlang",
                    "begin": "(#!syntax)\\s+(erlang)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.erlang" }]
                },
                {
                    "name": "meta.embedded.block.go",
                    "begin": "(#!syntax)\\s+(go)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.go" }]
                },
                {
                    "name": "meta.embedded.block.html",
                    "begin": "(#!syntax)\\s+(html)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "text.html.derivative" }]
                },
                {
                    "name": "meta.embedded.block.javascript",
                    "begin": "(#!syntax)\\s+(javascript)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.js" }]
                },
                {
                    "name": "meta.embedded.block.java",
                    "begin": "(#!syntax)\\s+(java)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.java" }]
                },
                {
                    "name": "meta.embedded.block.json",
                    "begin": "(#!syntax)\\s+(json)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.json" }]
                },
                {
                    "name": "meta.embedded.block.kotlin",
                    "begin": "(#!syntax)\\s+(kotlin)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.kotlin" }]
                },
                {
                    "name": "meta.embedded.block.lisp",
                    "begin": "(#!syntax)\\s+(lisp)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.lisp" }]
                },
                {
                    "name": "meta.embedded.block.lua",
                    "begin": "(#!syntax)\\s+(lua)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.lua" }]
                },
                {
                    "name": "meta.embedded.block.markdown",
                    "begin": "(#!syntax)\\s+(markdown)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "text.html.markdown" }]
                },
                {
                    "name": "meta.embedded.block.objectivec",
                    "begin": "(#!syntax)\\s+(objectivec)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.objc" }]
                },
                {
                    "name": "meta.embedded.block.perl",
                    "begin": "(#!syntax)\\s+(perl)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.perl" }]
                },
                {
                    "name": "meta.embedded.block.php",
                    "begin": "(#!syntax)\\s+(php)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.php" }]
                },
                {
                    "name": "meta.embedded.block.powershell",
                    "begin": "(#!syntax)\\s+(powershell)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.powershell" }]
                },
                {
                    "name": "meta.embedded.block.python",
                    "begin": "(#!syntax)\\s+(python)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.python" }]
                },
                {
                    "name": "meta.embedded.block.ruby",
                    "begin": "(#!syntax)\\s+(ruby)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.ruby" }]
                },
                {
                    "name": "meta.embedded.block.rust",
                    "begin": "(#!syntax)\\s+(rust)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.rust" }]
                },
                {
                    "name": "meta.embedded.block.sh",
                    "begin": "(#!syntax)\\s+(sh)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.shell" }]
                },
                {
                    "name": "meta.embedded.block.sql",
                    "begin": "(#!syntax)\\s+(sql)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.sql" }]
                },
                {
                    "name": "meta.embedded.block.swift",
                    "begin": "(#!syntax)\\s+(swift)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.swift" }]
                },
                {
                    "name": "meta.embedded.block.typescript",
                    "begin": "(#!syntax)\\s+(typescript)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "source.ts" }]
                },
                {
                    "name": "meta.embedded.block.xml",
                    "begin": "(#!syntax)\\s+(xml)",
                    "beginCaptures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    },
                    "end": "(?=\\}\\}\\})",
                    "patterns": [{ "include": "text.xml" }]
                },
                {
                    "match": "(#!syntax)\\s+(erlang|kotlin|lisp)",
                    "captures": {
                        "1": { "name": "keyword.control.bracket.namu" },
                        "2": { "name": "support.function.language-name.namu" }
                    }
                }
            ]
        },
        "footnotes": {
            "match": "\\[(\\*)",
            "captures": {
                "1": {
                    "name": "keyword.operator.namu"
                }
            }
        },
        "redirect": {
            "match": "^(#redirect) (.*)",
            "captures": {
                "1": {
                    "name": "keyword.control.namu"
                },
                "2": {
                    "name": "string.quoted.double.namu"
                }
            }
        },
        "tables": {
            "begin": "\\|\\|",
            "beginCaptures": {
                "0": { "name": "punctuation.definition.table.namu" }
            },
            "end": "(?= |\n|$)",
            "patterns": [
                {
                    "match": "(<)([^>=|]*(?:\\|[^>=|]+)?)(?:=([^>|]*))?(>)",
                    "captures": {
                        "1": {
                            "name": "punctuation.definition.tag.begin.namu"
                        },
                        "2": {
                            "name": "entity.other.attribute-name.table.namu"
                        },
                        "3": {
                            "name": "string.unquoted.attribute-value.table.namu"
                        },
                        "4": {
                            "name": "punctuation.definition.tag.end.namu"
                        }
                    }
                }
            ]
        },
        "wiki-style-line-css": {
            "match": "([-a-zA-Z0-9]+)\\s*:\\s*([^;]+)(?:;|$)",
            "captures": {
                "1": { "name": "support.type.property-name.css" },
                "2": { "name": "constant.numeric.css" }
            }
        }
    }
}
